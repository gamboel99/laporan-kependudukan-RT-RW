<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Laporan Kependudukan Bulanan â€” Pemerintah Desa Keling</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
<header class="header">
  <div class="container header-grid">
    <div class="logo-block">
      <h1>Pemerintah Desa Keling</h1>
      <p class="muted">Kecamatan Kepung â€” Kabupaten Kediri</p>
    </div>
    <div class="title-block">
      <div class="app-name">Laporan Kependudukan Bulanan</div>
      <div class="app-sub muted">Simpan draft â€” Finalisasi â€” Unduh Excel</div>
    </div>
  </div>
</header>

<nav class="nav">
  <button class="nav-btn active" data-target="dashboard">Dashboard</button>
  <button class="nav-btn" data-target="form">Form Entri</button>
  <button class="nav-btn" data-target="ringkasan">Ringkasan</button>
  <button class="nav-btn" data-target="tentang">Tentang</button>
</nav>

<main class="container">
  <!-- Dashboard -->
  <section id="dashboard" class="page">
    <div class="card">
      <h2>Panduan Singkat</h2>
      <p>Gunakan menu <strong>Form Entri</strong> untuk mengisi laporan bulanan. RT/RW dapat menyimpan sebagai draft dan melanjutkan. Setelah lengkap, klik <strong>Kirim Final</strong> untuk menyimpan; data akan otomatis muncul di Dashboard dan Ringkasan. Unduh Excel via menu Ringkasan.</p>
    </div>

    <div class="card">
      <h3>Status Entri Bulan Ini</h3>
      <p>Menunjukkan RT/RW yang <strong>Sudah Final</strong> dan yang <strong>Belum</strong> pada bulan yang dipilih.</p>
      <div class="status-controls">
        <label>Pilih Bulan: <input id="statusMonth" type="month" /></label>
        <button id="statusRefresh" class="btn small">Refresh</button>
      </div>
      <table id="statusTable">
        <thead><tr><th>RW</th><th>RT</th><th>Status</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <h3>Ringkasan Cepat</h3>
      <div class="row grid-3 summary-cards">
        <div class="col card-mini"><div class="label">Total KK</div><div id="sumKK">0</div></div>
        <div class="col card-mini"><div class="label">Total Penduduk</div><div id="sumPenduduk">0</div></div>
        <div class="col card-mini"><div class="label">RW Terdata</div><div id="countRW">0</div></div>
      </div>
    </div>
  </section>

  <!-- Form Entri -->
  <section id="form" class="page" style="display:none">
    <div class="card">
      <h2>Form Entri Bulanan</h2>
      <form id="entryForm" onsubmit="return false;">
        <div class="row">
          <div class="col"><label>Bulan Entri</label><input id="bulan" type="month" required /></div>
          <div class="col"><label>RW</label><input id="rw" type="text" placeholder="01" required /></div>
          <div class="col"><label>RT</label><input id="rt" type="text" placeholder="01" required /></div>
        </div>

        <h3>Jumlah Penduduk</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="pendudukL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="pendudukP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="pendudukTotal">0</div></div>
        </div>

        <h3>Jumlah KK</h3>
        <div class="row grid-1"><div class="col card-mini"><label>Jumlah KK</label><input id="jumlahKK" type="number" min="0" value="0" /></div></div>

        <h3>Jumlah Kelahiran</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="lahirL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="lahirP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="lahirTotal">0</div></div>
        </div>

        <h3>Jumlah Kematian</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="matiL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="matiP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="matiTotal">0</div></div>
        </div>

        <h3>Pindah Masuk</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="masukL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="masukP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="masukTotal">0</div></div>
        </div>

        <h3>Pindah Keluar</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="keluarL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="keluarP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="keluarTotal">0</div></div>
        </div>

        <h3>Penduduk Musiman / Mukim Sementara</h3>
        <div class="row grid-3">
          <div class="col card-mini"><label>Laki-laki</label><input id="musimanL" type="number" min="0" value="0" /></div>
          <div class="col card-mini"><label>Perempuan</label><input id="musimanP" type="number" min="0" value="0" /></div>
          <div class="col card-mini total"><label>Total</label><div id="musimanTotal">0</div></div>
        </div>

        <div class="actions">
          <button id="btnSaveDraft" class="btn ghost" type="button">ðŸ’¾ Simpan Draft</button>
          <button id="btnSubmitFinal" class="btn primary" type="button">âœ… Kirim Final</button>
          <button id="btnClear" class="btn" type="button">Reset Form</button>
        </div>
        <p id="formMsg" class="muted small"></p>
      </form>
    </div>

    <div class="card">
      <h3>Riwayat Input (Final)</h3>
      <div style="overflow:auto; max-height:320px">
        <table id="finalTable">
          <thead><tr><th>Bulan</th><th>RW</th><th>RT</th><th>KK</th><th>PL</th><th>PP</th><th>Total</th><th>Status</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Ringkasan -->
  <section id="ringkasan" class="page" style="display:none">
    <div class="card">
      <h2>Ringkasan & Grafik</h2>
      <div class="row">
        <div class="col"><label>Pilih Tahun</label><select id="filterYear"></select></div>
        <div class="col"><label>Pilih RW (opsional)</label><input id="filterRw" placeholder="Kosong = Semua" /></div>
        <div class="col actions-inline"><button id="btnRefresh" class="btn small">Refresh</button><button id="btnDownloadExcel" class="btn primary small">Download Excel (Workbook)</button></div>
      </div>

      <div class="chart-wrap">
        <canvas id="genderChart"></canvas>
      </div>

      <div class="card">
        <h3>Rekap Tabel</h3>
        <div style="overflow:auto; max-height:260px;">
          <table id="rekapTable"><thead><tr><th>Bulan</th><th>RW</th><th>RT</th><th>KK</th><th>PL</th><th>PP</th><th>Total</th></tr></thead><tbody></tbody></table>
        </div>
      </div>
    </div>
  </section>

  <!-- Tentang -->
  <section id="tentang" class="page" style="display:none">
    <div class="card">
      <h2>Tentang Aplikasi</h2>
      <p>Aplikasi sederhana untuk memudahkan pelaporan kependudukan bulanan oleh RT/RW Desa Keling.</p>
      <h4>Kontak Admin</h4>
      <ul class="muted">
        <li>Bapak Wawi: +62 856-4900-4228</li>
        <li>Bapak Didin: +62 858-5988-7355</li>
        <li>Bapak Arsa: +62 815-5588-8095</li>
      </ul>
    </div>
  </section>
</main>

<footer class="footer">
  <div class="container">
    <div style="font-weight:700">Pemerintah Desa Keling</div>
    <div class="muted">Hubungi admin jika ada masalah teknis</div>
  </div>
</footer>

<script src="assets/js/app.js"></script>
</body>
</html>
